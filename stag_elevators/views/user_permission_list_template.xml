<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="user_permission_list_template" name="User Permission List Template">
    <t t-call="website.layout">
        <div class="container mt-4 mb-4">

            <!-- Breadcrumb and Buttons in the same row -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <!-- Breadcrumb -->
                <nav aria-label="breadcrumb" class="mb-0">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item">
                            <a href="#"><i class="bi bi-house-door"></i> Home</a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">
                            User Role
                        </li>
                    </ol>
                </nav>

                <!-- Action Buttons -->
                <div class="d-flex gap-2">
                    <a href="/Dashboard" class="btn btn-dark">‚Üê Back</a>
                    <a href="/user_permission/create" class="btn btn-dark">+ Create</a>
                </div>
            </div>

            <!-- Table -->
            <div><div style="padding:15px; background:white;">
            <table id="userPermissionTable" class="table table-bordered table-striped display" style="width:100%">
                <thead>
                    <tr>
                        <th>S No</th>
                        <th>User Role</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-set="counter" t-value="0"/>
                    <t t-foreach="roles" t-as="role">
                        <t t-set="counter" t-value="counter + 1"/>
                        <tr>
                            <td><t t-esc="counter"/></td>
                            <td><t t-esc="role.name"/></td>
                            <td>
                                <a t-att-href="'/user_permission/edit/%d' % role.id" class="me-2" title="Edit">
                                    <i class="fa fa-pen text-primary" style="font-size: 16px;"></i>
                                </a>
                                <a t-att-href="'/user_permission/delete/%d' % role.id" title="Delete"
                                   onclick="return confirm('Are you sure you want to delete this permission?')">
                                    <i class="fa fa-trash text-danger" style="font-size: 16px;"></i>
                                </a>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
        </div>
        </div></div>

        <!-- DataTables Scripts -->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css"/>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
        <script>
            $(document).ready(function () {
                $('#userPermissionTable').DataTable();
            });
        </script>

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    </t>
</template>


    <template id="user_role_create_template" name="User Role Create">
    <t t-call="website.layout">
        <div class="container mt-5 p-4 bg-white shadow rounded">

            <!-- Header and Back Button -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="mb-0">Create User Role</h2>
                <a href="/user_permission/list" class="btn btn-dark">‚Üê Back</a>
            </div>

            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-4">
                    <li class="breadcrumb-item"><a href="/">Home</a></li>
                    <li class="breadcrumb-item"><a href="/user_permission/list">User Role</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Create</li>
                </ol>
            </nav>
            <t t-if="request.params.get('error') == 'role_duplicate'"> 
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        This role already exist. 
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            </t>

            <!-- Form -->
            <form action="/user_permission/save" method="POST">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                <div class="form-group mb-3">
                    <label for="role_name">User Role</label>
                    <input type="text" id="role_name" name="name" class="form-control"
                           placeholder="Enter role name" required="required"/>
                </div>
                <div class="form-check mb-3">
                    <input type="checkbox" id="is_admin" name="is_admin" class="form-check-input"
                        />
                    <label for="is_admin" class="form-check-label">Is Admin</label>
                </div>

                <div class="text-end mt-4">
                    <button type="submit" class="btn btn-dark me-2">Submit</button>
                    <a href="/user_permission/list" class="btn btn-light border">Cancel</a>
                </div>
            </form>

        </div>
    </t>
</template>

<template id="user_permission_edit_template" name="User Role Edit">
    <t t-call="website.layout">
        <div class="container mt-5 p-4 bg-white shadow rounded">

            <!-- Header and Back Button -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="mb-0">Edit User Role</h2>
                <a href="/user_permission/list" class="btn btn-dark">‚Üê Back</a>
            </div>

            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-4">
                    <li class="breadcrumb-item"><a href="/">Home</a></li>
                    <li class="breadcrumb-item"><a href="/user_permission/list">User Role</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Edit</li>
                </ol>
            </nav>

            <!-- Form -->
            <form action="/user_permission/update" method="POST">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <input type="hidden" name="role_id" t-att-value="role.id"/>

                <div class="form-group mb-3">
                    <label for="role_name">User Role</label>
                    <input type="text" id="role_name" name="name" class="form-control"
                           placeholder="Enter role name" required="required"
                           t-att-value="role.name"/>
                </div>
                <div class="form-check mb-3">
                    <input type="checkbox" id="is_admin" name="is_admin" class="form-check-input"
                        t-att-checked="role.is_admin and 'checked' or None"/>
                    <label for="is_admin" class="form-check-label">Is Admin</label>
                </div>

                <!-- <div class="form-check mb-3">
                    <input type="checkbox" id="ismy" name="ismy" class="form-check-input"
                           t-att-checked="role.ismy and 'checked' or None"/>
                    <label for="ismy" class="form-check-label">ISM Y</label>
                </div> -->

                <div class="text-end mt-4">
                    <button type="submit" class="btn btn-dark me-2">Update</button>
                    <a href="/user_permission/list" class="btn btn-light border">Cancel</a>
                </div>
            </form>

        </div>
    </t>
</template>



<!-- ============================= user permission ============================= -->

<template id="user_permission_role_list_template" name="User Permission List Template">

    <t t-call="website.layout">
        <div class="container mt-4 mb-4">

            <!-- Breadcrumb and Buttons in the same row -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <!-- Breadcrumb -->
                <nav aria-label="breadcrumb" class="mb-0">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item">
                            <a href="#"><i class="bi bi-house-door"></i> Home</a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">
                            User Permissions
                        </li>
                    </ol>
                </nav>

                <!-- Action Buttons -->
                <div class="d-flex gap-2">
                    <a href="/Dashboard" class="btn btn-dark">‚Üê Back</a>
                </div>
            </div>

            <!-- Table -->
            <div><div style="padding:15px; background:white;">
            <table id="userPermissionRoleTable" class="table table-bordered table-striped display" style="width:100%">
                <thead>
                    <tr>
                        <th>S No</th>
                        <th>User Role</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-set="counter" t-value="0"/>
                    <t t-foreach="roles" t-as="role">
                        <t t-set="counter" t-value="counter + 1"/>
                        <tr>
                            <td><t t-esc="counter"/></td>
                            <td><t t-esc="role.name"/></td>
                            <td>
                                <a t-att-href="'/user_permission/permissions/%d' % role.id" class="me-2" title="Edit">
                                    <i class="fa fa-pen text-primary" style="font-size: 16px;"></i>
                                </a>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
            </div></div>
        </div>

        <!-- DataTables Scripts -->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css"/>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
        <script>
            $(document).ready(function () {
                $('#userPermissionRoleTable').DataTable();
            });
        </script>

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    </t>
</template>

<template id="user_permission_template_edit" name="User Permission Page">
<t t-call="website.layout">

            <div class="container my-4">
                <!-- Header -->
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3>User Permission</h3>
                    <a href="/user_permissions" class="btn btn-dark">‚Üê Back</a>
                </div>

                <!-- Table -->
                <form action="/user_permissions/save" method="post">
                    <input type="hidden" name="role_id" t-att-value="role.id"/>
                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>Menu Category</th>
                                <th>Menu Name</th>
                                <th>Enable Permission</th>
                                
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Admin</td>
                                <td>User Role</td>
                                <td>
                                    <select class="form-select form-select-sm" name="user_role">
                                        <option t-att-selected="has_access(role, 'res.groups')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'res.groups')" value="No">No</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Admin</td>
                                <td>City Creation</td>
                                <td>
                                    <select class="form-select form-select-sm" name="city_creation">
                                        <option t-att-selected="has_access(role, 'res.city')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'res.city')" value="No">No</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Admin</td>
                                <td>User Permissions</td>
                                <td>
                                    <select class="form-select form-select-sm" name="user_permissions">
                                        <option t-att-selected="has_access(role, 'ir.model.access')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'ir.model.access')" value="No" >No</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Admin</td>
                                <td>User Creation</td>
                                <td>
                                    <select class="form-select form-select-sm" name="user_creation">
                                        <option t-att-selected="has_access(role, 'res.users')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'res.users')" value="No" >No</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Admin</td>
                                <td>Lead Stages</td>
                                <td>
                                    <select class="form-select form-select-sm" name="lead_stage">
                                        <option t-att-selected="has_access(role, 'crm.stage')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'crm.stage')" value="No" >No</option>
                                    </select>
                                </td>
                            </tr>

                            <tr>
                                <td>Admin</td>
                                <td>Quotation</td>
                                <td>
                                    <select class="form-select form-select-sm" name="quotation">
                                        <option t-att-selected="has_access(role, 'ir.attachment')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'ir.attachment')" value="No" >No</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Leads</td>
                                <td>Opportunity Creation</td>
                                <td>
                                    <select class="form-select form-select-sm" name="opportunity_creation">
                                        <option t-att-selected="has_access(role, 'crm.lead')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'crm.lead')" value="No" >No</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Leads</td>
                                <td>Leads Followups</td>
                                <td>
                                    <select class="form-select form-select-sm" name="lead_followup">
                                        <option t-att-selected="has_access(role, 'lead.followup')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'lead.followup')" value="No" >No</option>
                                    </select>
                                </td>
                            </tr>

                            <tr>
                                <td>CRM</td>
                                <td>CRM</td>
                                <td>
                                    <select class="form-select form-select-sm" name="crm">
                                        <option t-att-selected="has_access(role, 'crm.client')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'crm.client')" value="No" >No</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Production</td>
                                <td>Production</td>
                                <td>
                                    <select class="form-select form-select-sm" name="production">
                                        <option t-att-selected="has_access(role, 'production.client')" value="Yes" >Yes</option>
                                        <option t-att-selected="not has_access(role, 'production.client')" value="No" >No</option>
                                    </select>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="mt-3">
                        <button type="submit" class="btn btn-success">Save Permissions</button>
                    </div>
                </form>
            </div>
        </t> 
    </template>
    <template id="access_denied_template" name="Access Denied Page">
        <t t-call="website.layout">
            <div class="container my-5 text-center">
                <h2 class="text-danger">üö´ Access Denied</h2>
                <p>You do not have the necessary permissions to access this page.</p>
                <a href="/" class="btn btn-primary mt-3">Go Back to Home</a>
            </div>
        </t>
    </template>


</odoo>